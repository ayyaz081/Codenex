<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Button Test Results</title>
    <style>
        body { font-family: monospace; margin: 20px; background: #f5f5f5; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .loading { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        h1 { color: #333; }
        .button-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin: 20px 0; }
        .button { padding: 10px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .button:hover { background: #0056b3; }
        #console { background: #000; color: #0f0; padding: 15px; border-radius: 5px; height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <h1>üß™ Header Button Functionality Test</h1>
    <div id="test-results"></div>
    
    <div class="button-grid">
        <button class="button" onclick="testDirectAccess()">Test Direct Button Access</button>
        <button class="button" onclick="testMobileResponsive()">Test Mobile Responsive</button>
        <button class="button" onclick="testJavaScriptLoad()">Test JavaScript Loading</button>
        <button class="button" onclick="clearResults()">Clear Results</button>
    </div>
    
    <h2>Console Output:</h2>
    <div id="console"></div>
    
    <script>
        let results = [];
        let consoleOutput = [];
        
        // Override console.log to capture output
        const originalLog = console.log;
        console.log = function(...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : String(arg)).join(' ');
            consoleOutput.push(`[${timestamp}] ${message}`);
            updateConsole();
            originalLog.apply(console, args);
        };
        
        function addResult(message, type = 'info') {
            results.push({ message, type, timestamp: new Date().toLocaleTimeString() });
            updateResults();
        }
        
        function updateResults() {
            const container = document.getElementById('test-results');
            container.innerHTML = results.map(result => 
                `<div class="test-result ${result.type}">
                    [${result.timestamp}] ${result.message}
                </div>`
            ).join('');
        }
        
        function updateConsole() {
            const container = document.getElementById('console');
            container.textContent = consoleOutput.join('\n');
            container.scrollTop = container.scrollHeight;
        }
        
        function clearResults() {
            results = [];
            consoleOutput = [];
            updateResults();
            updateConsole();
        }
        
        async function testDirectAccess() {
            addResult('üîç Testing direct access to header buttons...', 'loading');
            
            try {
                // Test if we can access the main page
                const response = await fetch('http://localhost:7150/');
                if (response.ok) {
                    addResult('‚úÖ Main page accessible', 'success');
                } else {
                    addResult(`‚ùå Main page not accessible: ${response.status}`, 'error');
                    return;
                }
                
                // Test JavaScript files
                const jsResponse = await fetch('http://localhost:7150/js/shared-components.js');
                if (jsResponse.ok) {
                    addResult('‚úÖ SharedComponents JavaScript accessible', 'success');
                } else {
                    addResult(`‚ùå SharedComponents JavaScript not accessible: ${jsResponse.status}`, 'error');
                }
                
                // Test CSS files
                const cssResponse = await fetch('http://localhost:7150/css/shared-styles.css');
                if (cssResponse.ok) {
                    addResult('‚úÖ Shared CSS accessible', 'success');
                } else {
                    addResult(`‚ùå Shared CSS not accessible: ${cssResponse.status}`, 'error');
                }
                
                // Test header component
                const headerResponse = await fetch('http://localhost:7150/components/header.html');
                if (headerResponse.ok) {
                    addResult('‚úÖ Header component accessible', 'success');
                } else {
                    addResult(`‚ùå Header component not accessible: ${headerResponse.status}`, 'error');
                }
                
            } catch (error) {
                addResult(`‚ùå Error testing direct access: ${error.message}`, 'error');
            }
        }
        
        function testMobileResponsive() {
            addResult('üì± Testing mobile responsive behavior...', 'loading');
            
            // Simulate different screen sizes
            const sizes = [
                { width: 1200, height: 800, name: 'Desktop' },
                { width: 768, height: 1024, name: 'Tablet' },
                { width: 375, height: 667, name: 'Mobile' }
            ];
            
            sizes.forEach(size => {
                // We can't actually resize the window in a test, but we can check CSS
                addResult(`üìê Would test ${size.name} (${size.width}x${size.height})`, 'info');
            });
            
            addResult('‚úÖ Mobile responsive test simulation complete', 'success');
        }
        
        function testJavaScriptLoad() {
            addResult('üîß Testing JavaScript functionality...', 'loading');
            
            // Create an iframe to load the main page and test functionality
            const iframe = document.createElement('iframe');
            iframe.src = 'http://localhost:7150/debug-buttons.html';
            iframe.style.width = '1px';
            iframe.style.height = '1px';
            iframe.style.opacity = '0';
            iframe.style.position = 'absolute';
            iframe.style.top = '-1000px';
            
            iframe.onload = function() {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    
                    // Check if SharedComponents is loaded
                    const hasSharedComponents = iframe.contentWindow.sharedComponents || iframe.contentWindow.SharedComponents;
                    if (hasSharedComponents) {
                        addResult('‚úÖ SharedComponents loaded in iframe', 'success');
                    } else {
                        addResult('‚ùå SharedComponents not found in iframe', 'error');
                    }
                    
                    // Check for specific buttons
                    const buttons = [
                        'theme-toggle',
                        'nav-toggle', 
                        'search-icon-container'
                    ];
                    
                    buttons.forEach(buttonId => {
                        const button = iframeDoc.getElementById(buttonId);
                        if (button) {
                            addResult(`‚úÖ Button found: ${buttonId}`, 'success');
                        } else {
                            addResult(`‚ùå Button not found: ${buttonId}`, 'error');
                        }
                    });
                    
                } catch (error) {
                    addResult(`‚ùå Error testing iframe: ${error.message}`, 'error');
                }
                
                // Clean up
                document.body.removeChild(iframe);
                addResult('‚úÖ JavaScript load test complete', 'success');
            };
            
            iframe.onerror = function() {
                addResult('‚ùå Failed to load test iframe', 'error');
                document.body.removeChild(iframe);
            };
            
            document.body.appendChild(iframe);
        }
        
        // Auto-run initial tests
        window.addEventListener('load', function() {
            console.log('üöÄ Button test page loaded');
            addResult('üöÄ Test page initialized', 'info');
            
            // Wait a moment then run basic tests
            setTimeout(() => {
                testDirectAccess();
            }, 1000);
        });
        
        // Test responsive behavior
        window.addEventListener('resize', function() {
            console.log(`üìê Window resized to: ${window.innerWidth}x${window.innerHeight}`);
        });
    </script>
</body>
</html>
