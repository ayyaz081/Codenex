<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Admin Dynamic Loading</title>
</head>
<body>
    <h1>Testing Admin Dynamic Loading</h1>
    
    <h2>Product Domains</h2>
    <select id="productDomain">
        <option value="">Select Domain</option>
    </select>
    
    <h2>Product Domain Filter</h2>
    <select id="productDomainFilter">
        <option value="">All Domains</option>
    </select>
    
    <h2>Solution Problem Areas</h2>
    <select id="solutionProblemArea">
        <option value="">Select Problem Area</option>
    </select>
    
    <h2>Publication Domains</h2>
    <select id="publicationDomain">
        <option value="">Select Domain</option>
    </select>
    
    <h2>Repository Categories</h2>
    <select id="repositoryCategory">
        <option value="">Select Category</option>
    </select>

    <script>
        const API_BASE_URL = "https://localhost:7151/api";
        
        // Load product domains from API and populate form dropdown
        async function loadProductDomains() {
            try {
                console.log('Loading product domains...');
                const response = await fetch(`${API_BASE_URL}/Products/domains`);
                console.log('Product domains response:', response.status);
                if (response.ok) {
                    const domainData = await response.json();
                    console.log('Product domains data:', domainData);
                    // Extract just the domain names from the API response
                    const domains = domainData.map(item => item.domain);
                    console.log('Extracted domains:', domains);
                    populateProductDomainSelect(domains);
                }
            } catch (error) {
                console.error('Error loading product domains:', error);
            }
        }
        
        // Load product domains for filter dropdown
        async function loadProductDomainFilter() {
            try {
                console.log('Loading product domain filter...');
                const response = await fetch(`${API_BASE_URL}/Products/domains`);
                if (response.ok) {
                    const domainData = await response.json();
                    const domains = domainData.map(item => item.domain);
                    populateProductDomainFilter(domains);
                }
            } catch (error) {
                console.error('Error loading product domain filter:', error);
            }
        }
        
        // Load solution problem areas from API and populate form dropdown
        async function loadSolutionProblemAreas() {
            try {
                console.log('Loading solution problem areas...');
                const response = await fetch(`${API_BASE_URL}/Solutions/problem-areas`);
                if (response.ok) {
                    const problemAreas = await response.json();
                    console.log('Problem areas data:', problemAreas);
                    populateSolutionProblemAreaSelect(problemAreas);
                }
            } catch (error) {
                console.error('Error loading solution problem areas:', error);
            }
        }
        
        // Load publication domains from API and populate form dropdown
        async function loadPublicationDomains() {
            try {
                console.log('Loading publication domains...');
                const response = await fetch(`${API_BASE_URL}/Publications/domains`);
                if (response.ok) {
                    const domains = await response.json();
                    console.log('Publication domains data:', domains);
                    populatePublicationDomainSelect(domains);
                }
            } catch (error) {
                console.error('Error loading publication domains:', error);
            }
        }
        
        // Load repository categories from API and populate form dropdown
        async function loadRepositoryCategories() {
            try {
                console.log('Loading repository categories...');
                const response = await fetch(`${API_BASE_URL}/Repository/categories`);
                if (response.ok) {
                    const categories = await response.json();
                    console.log('Repository categories data:', categories);
                    populateRepositoryCategorySelect(categories);
                }
            } catch (error) {
                console.error('Error loading repository categories:', error);
            }
        }
        
        // Populate functions
        function populateProductDomainSelect(domains) {
            const select = document.getElementById('productDomain');
            domains.forEach(domain => {
                const option = document.createElement('option');
                option.value = domain;
                option.textContent = domain;
                select.appendChild(option);
            });
            console.log(`Added ${domains.length} product domains to form select`);
        }
        
        function populateProductDomainFilter(domains) {
            const select = document.getElementById('productDomainFilter');
            domains.forEach(domain => {
                const option = document.createElement('option');
                option.value = domain;
                option.textContent = domain;
                select.appendChild(option);
            });
            console.log(`Added ${domains.length} product domains to filter select`);
        }
        
        function populateSolutionProblemAreaSelect(problemAreas) {
            const select = document.getElementById('solutionProblemArea');
            problemAreas.forEach(area => {
                const option = document.createElement('option');
                option.value = area;
                option.textContent = area;
                select.appendChild(option);
            });
            console.log(`Added ${problemAreas.length} problem areas to select`);
        }
        
        function populatePublicationDomainSelect(domains) {
            const select = document.getElementById('publicationDomain');
            domains.forEach(domain => {
                const option = document.createElement('option');
                option.value = domain;
                option.textContent = domain;
                select.appendChild(option);
            });
            console.log(`Added ${domains.length} publication domains to select`);
        }
        
        function populateRepositoryCategorySelect(categories) {
            const select = document.getElementById('repositoryCategory');
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                select.appendChild(option);
            });
            console.log(`Added ${categories.length} repository categories to select`);
        }
        
        // Load everything on page load
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('Loading all dynamic categories...');
            await loadProductDomains();
            await loadProductDomainFilter();
            await loadSolutionProblemAreas();
            await loadPublicationDomains();
            await loadRepositoryCategories();
            console.log('Finished loading categories');
        });
    </script>
</body>
</html>
